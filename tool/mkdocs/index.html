<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <meta name="author" content="朽木自雕">
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>mkdocs简单使用 - BurningMyself</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "mkdocs\u7b80\u5355\u4f7f\u7528";
    var mkdocs_page_input_path = "tool\\mkdocs.md";
    var mkdocs_page_url = "/tool/mkdocs/";
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> BurningMyself</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="../..">介绍</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">技术博文</span>
    <ul class="subnav">
                <li class="">
                    
    <span class="caption-text">.NET</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../net/c_sharp/">C# 6</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../net/c_docker/">.Ner Core Docker 部署</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../net/c_mysql_nginx/">使用 Docker 容器化部署 ASP.NET Core + MySQL + Nginx</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../net/c_core_safety/">让你的ASP.NET Core应用程序更安全</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../net/c_core_study_route/">ASP.NET Core开发者指南</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">Java</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../java/feature/">Java特性</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../java/load-class/">Java类加载</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../java/orm/">Orm的优缺点</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../java/bio-nio/">BIO与NIO</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../java/rocketmq/rmq-1/">RocketMq下载与安装</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../java/springAnnotation/">Spring常用注解</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">Python</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../python/feature/">Python特性</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../python/str_joint/">Python字符拼接</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../python/syntax_rule/">Python语法技巧</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../python/fabric/">远程部署神器 Fabric</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">PHP</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../php/kj/">框架</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">Web</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../web/es6/">es6语法</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../web/ali_js_style/">阿里js样式规范</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../web/node.js/">node.js文档</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../web/react/">React 开发者指南</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../dart/syntax/">Dart语法学习</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../web/react_interview/">React 面试</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../web/js_tool_method/">js 工具函数</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../web/vue_cp_react/">vue与react比较</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">SQL</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../sql/mysql_yh/">MySQL优化</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../sql/mysql_yh17/">MySQL优化</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../sql/mysql_log/">MySQL日志</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../sql/mysql_index/">MySQL索引</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../sql/mysql_pxc/">MySQL PXC集群</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../sql/mysql_use/">MySQL 数据库应用</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../sql/sql_server_master/">Sql Server 主从备份</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../sql/data_split/">数据库之互联网常用分库分表方案</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../sql/mybatis/">Mybatis使用心德</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">Linux</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../linux/often/">常用命令</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../linux/ope/">实用的Linux 命令</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">Docker</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../docker/docker/">Docker全科</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../docker/docker-compose/">docker和docker-compose 配置 mysql mongodb redis nginx jenkins 环境</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../docker/docker-jenkins/">Docker部署Jenkins</a>
                </li>
    </ul>
                </li>
                <li class=" current">
                    
    <span class="caption-text">Tool</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../git/">Git</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../gitquestion/">Git问题处理</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../gitflow/">GitFlow</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../gitbook/">GitBook</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../gitcmr/">Git提交日志规范</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../markdown/">Markdown</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../cicd/">CI/CD</a>
                </li>
                <li class="toctree-l3 current">
                    
    <a class="current" href="./">mkdocs简单使用</a>
    <ul class="subnav">
            
    <li class="toctree-l4"><a href="#mkdocs">mkdocs简单使用</a></li>
    
        <ul>
        
            <li><a class="toctree-l5" href="#_1">一、安装</a></li>
        
            <li><a class="toctree-l5" href="#_2">二、配置文件</a></li>
        
            <li><a class="toctree-l5" href="#_3">三、简单配置</a></li>
        
            <li><a class="toctree-l5" href="#_4">中文搜索问题</a></li>
        
        </ul>
    

    </ul>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../gitstudy/">Git的黑魔法</a>
                </li>
    </ul>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">微服务</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../micro/spring-cloud/">基于SpringCloud的微服务架构演变史</a>
                </li>
                <li class="">
                    
    <a class="" href="../../micro/fbs-lock/">分布式锁</a>
                </li>
                <li class="">
                    
    <a class="" href="../../micro/design/">微服务设计</a>
                </li>
                <li class="">
                    
    <a class="" href="../../micro/distrimsg/">分布式系统与消息的投递</a>
                </li>
                <li class="">
                    
    <a class="" href="../../micro/ddd/">基于DDD的微服务设计和开发实战</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">经验分析</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../exp/devops/">DevOps</a>
                </li>
                <li class="">
                    
    <a class="" href="../../exp/micro-service/">Micro-Service</a>
                </li>
                <li class="">
                    
    <a class="" href="../../exp/raft-gossip/">Raft算法和Gossip协议</a>
                </li>
                <li class="">
                    
    <a class="" href="../../exp/cl/">集群和负载均衡</a>
                </li>
                <li class="">
                    
    <a class="" href="../../exp/ai/">人工智能</a>
                </li>
                <li class="">
                    
    <a class="" href="../../exp/code-principle/">代码原则</a>
                </li>
                <li class="">
                    
    <a class="" href="../../exp/techbig/">如何成为技术大牛</a>
                </li>
                <li class="">
                    
    <a class="" href="../../exp/learnweetout/">程序员如何技术成长</a>
                </li>
                <li class="">
                    
    <a class="" href="../../exp/pt/">产品与技术</a>
                </li>
                <li class="">
                    
    <a class="" href="../../exp/four_deep_learning/">深度学习框架</a>
                </li>
                <li class="">
                    
    <a class="" href="../../exp/tl/">在阿里做了5年技术Leader，我总结出这些套路！</a>
                </li>
                <li class="">
                    
    <a class="" href="../../exp/cto/">CTO 技能图谱</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">医学</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../doctor/ae/">脑炎</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">构架</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../framework/split/">构架拆分</a>
                </li>
                <li class="">
                    
    <a class="" href="../../framework/fgb/">分布式、高并发、多线程</a>
                </li>
                <li class="">
                    
    <a class="" href="../../framework/agility/">如何理解敏捷开发</a>
                </li>
                <li class="">
                    
    <a class="" href="../../framework/fwork/">走向架构师必备的技能</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">情感</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../emotion/eq/">情商</a>
                </li>
                <li class="">
                    
    <a class="" href="../../emotion/workheard/">工作心得</a>
                </li>
                <li class="">
                    
    <a class="" href="../../emotion/lookbook/">看书</a>
                </li>
                <li class="">
                    
    <a class="" href="../../emotion/fmf/">4种男朋友</a>
                </li>
                <li class="">
                    
    <a class="" href="../../emotion/notheart/">不上心</a>
                </li>
                <li class="">
                    
    <a class="" href="../../emotion/selfdiscipline/">自律</a>
                </li>
                <li class="">
                    
    <a class="" href="../../emotion/notlike/">喜欢与不喜欢</a>
                </li>
                <li class="">
                    
    <a class="" href="../../emotion/latemarry/">晚婚</a>
                </li>
                <li class="">
                    
    <a class="" href="../../emotion/understand/">追女生要明白这些事</a>
                </li>
                <li class="">
                    
    <a class="" href="../../emotion/backup/">备胎</a>
                </li>
                <li class="">
                    
    <a class="" href="../../emotion/chase/">为什么追不到她</a>
                </li>
                <li class="">
                    
    <a class="" href="../../emotion/livefail/">为什么活着失败</a>
                </li>
                <li class="">
                    
    <a class="" href="../../emotion/emotion/">情绪管理</a>
                </li>
                <li class="">
                    
    <a class="" href="../../emotion/abolish/">废掉的三个迹象</a>
                </li>
                <li class="">
                    
    <a class="" href="../../emotion/uptime/">余生，好好珍惜</a>
                </li>
                <li class="">
                    
    <a class="" href="../../emotion/losecome/">所有的失去，都会以另一种方式归来</a>
                </li>
                <li class="">
                    
    <a class="" href="../../emotion/threeheart/">人生有这三种好心态</a>
                </li>
                <li class="">
                    
    <a class="" href="../../emotion/onelike/">一个感情真相</a>
                </li>
                <li class="">
                    
    <a class="" href="../../emotion/notruth/">情商与道理</a>
                </li>
                <li class="">
                    
    <a class="" href="../../emotion/smf/">六种男人远离</a>
                </li>
                <li class="">
                    
    <a class="" href="../../emotion/select/">决定接下来人生归属的，不是努力，而是选择</a>
                </li>
                <li class="">
                    
    <a class="" href="../../emotion/nolike/">被你拉黑的那个人，你一定很喜欢吧</a>
                </li>
                <li class="">
                    
    <a class="" href="../../emotion/onepath/">余生，学会一个人走，不管有没有人陪</a>
                </li>
                <li class="">
                    
    <a class="" href="../../emotion/twopath/">往后余生还很精彩，别被熬夜拖垮了</a>
                </li>
                <li class="">
                    
    <a class="" href="../../emotion/lifetime/">心态好的人，一辈子都好</a>
                </li>
                <li class="">
                    
    <a class="" href="../../emotion/hearttoheart/">将心比心，方得人心</a>
                </li>
                <li class="">
                    
    <a class="" href="../../emotion/ttt/">别睡太晚，别爱太满，别要太多</a>
                </li>
                <li class="">
                    
    <a class="" href="../../emotion/profess/">表白</a>
                </li>
    </ul>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">BurningMyself</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Tool &raquo;</li>
        
      
        
          <li>技术博文 &raquo;</li>
        
      
    
    <li>mkdocs简单使用</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/burningmyself/burningmyself.github.io/edit/master/docs/tool/mkdocs.md"> Edit on burningmyself/blog</a>
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="mkdocs">mkdocs简单使用<a class="headerlink" href="#mkdocs" title="Permanent link">&para;</a></h1>
<p><a href="http://www.mkdocs.org/">官网</a></p>
<h2 id="_1">一、安装<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<pre class="codehilite"><code class="language-python"># 查看 python 版本
python --version
# Python 2.7.2

# 查看 pip 版本
pip --version
# pip 1.5.2

# 更新 pip
pip install --upgrade pip

# 安装 mkdocs
pip install mkdocs
pip install --upgrade mkdocs

# 查看 mkdocs 版本
mkdocs --version
# mkdocs, version 0.17.3

# 查看帮助
mkdocs --help
# 查看具体命令的帮助
mkdocs build --help

# get started
mkdocs new my-project
cd my-project

# 实时测试
mkdocs serve -a 0.0.0.0:8000

# 打包成静态文件
mkdocs build --clean
# 打包到特定文件夹
mkdocs build --clean -d ./myFiles</code></pre>


<h2 id="_2">二、配置文件<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h2>
<p>默认使用的配置文件是 ./mkdocs.yml
使用的目录是 ./docs/
./mkdocs.yml 配置文件的一般内容是:</p>
<pre class="codehilite"><code class="language-yml">site_name: webSite_Title
pages:
- index.md
- about.md

theme: readthedocs</code></pre>


<p>如果不配置 pages , 那么 mkdocs 会自动遍历检索 ./docs 目录中的所有 md 文档，并生成 pages 内容,但是是按照字母顺序排序的，如果需要，还是手动设置 pages 内容
pages 使用 HOME 作为 index.md 的标题 , About 作为 about.md 的标题
并且使用 index.md 作为显示首页, pages 中没有配置 index.md 首页会无法显示
所以一般的配置都是</p>
<pre class="codehilite"><code class="language-yml">pages:
- Home: index.md
- User Guide:
    - 'Writing your docs': 'user-guide/writing-your-docs.md'
    - 'Styling your docs': 'user-guide/styling-your-docs.md'
- About:
    - 'License': 'about/license.md'
    - 'Release Notes': 'about/release-notes.md'</code></pre>


<p>mkdocs 包含了两个内置的 theme: mkdocs 和 readthedocs
mkdocs 是默认的theme
当然你也可以创建自己的theme,或使用第三方theme，例如</p>
<pre class="codehilite"><code class="language-python">pip install windmill
pip install --upgrade windmill

# 然后指定 theme: windmill</code></pre>


<p>docs_dir 可以让你指定 docs/ 目录的位置
site_dir 可以让你指定 build后的输出目录位置
dev_addr 可以让你指定 serve 时监听的 IP:port</p>
<p>还有 plugins</p>
<h2 id="_3">三、简单配置<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h2>
<pre class="codehilite"><code class="language-python">#!/bin/bash

# ================ 基础功能区 ================ 
scriptDir=$(dirname $(readlink -f $0))  
scriptName=$(basename $0)


# ================ 函数定义区 ================
# 获取git项目名称映射的中文名称,retCode=155表示映射到了
function getMapNameForGitProjectName {

  # 第一个参数是 git项目名称
  local gitProjectName=&quot;$1&quot;
  # 获取git项目名称为 xxx.git 
  local tmpBaseName=$(basename ${gitProjectName})
  # 去掉 .git
  local tmpOriProjName=${tmpBaseName%.*}

  # 声明使用的映射文件
  local tmpMappingFile=&quot;${scriptDir}/mapForProject.txt&quot;
  if (! [ -e ${tmpMappingFile} ]);then
    echo ${tmpOriProjName}
    return 0
  fi

  # 查找 git项目名称:yyy 中冒号后面的部分
  local tmpMappedName=$(grep -oP &quot;(?&lt;=${tmpOriProjName}:).*$&quot; ${tmpMappingFile})
  if ([ -n &quot;${tmpMappedName}&quot; ]);then
    echo ${tmpMappedName}
    return 155
  else
    echo ${tmpOriProjName} 
  fi

}

# 遍历 映射文件, 匹配nginx根目录中的文件夹,生成连接
function doAddLinkForProjectInMap {
  # 第一个参数是 nginx根目录
  local nginxRootDir=&quot;$1&quot;

  # 第二个参数是 index.html ，表示要追加内容的文件
  local indexFile=&quot;$2&quot;

  if ([ -z &quot;${nginxRootDir}&quot; ]);then
    echo &quot;为doAddLinkForProjectInMap函数提供的参数错误&quot;
    return 1
  fi 

  if ([ -z &quot;${indexFile}&quot; ]);then
    echo &quot;为doAddLinkForProjectInMap函数提供的参数错误&quot;
    return 1
  fi 

  # 声明使用的映射文件
  local tmpMappingFile=&quot;${scriptDir}/mapForProject.txt&quot;
  if (! [ -e ${tmpMappingFile} ]);then
    echo &quot;映射文件不存在&quot;
    return 1
  fi

  # 追加 ul 到 indexFile
  cat &gt;&gt; ${indexFile} &lt;&lt;EOF
&lt;ul&gt;
EOF

  for line in `cat ${tmpMappingFile}`;do 
    # 获取每一行冒号前面的部分
    tmpDirName=${line%%:*} # 匹配 $string的后缀 的最长匹配,然后删除,支持正则表达式
    tmpMapName=${line#*:} # 匹配 $string的前缀 的最短匹配,然后删除,支持正则表达式

    if ([ -z &quot;${tmpDirName}&quot; ]);then
      continue
    fi

    if ([ -e &quot;${nginxRootDir}/${tmpDirName}&quot; ]);then
      # 如果存在该文件夹
      echo &quot;&lt;li&gt;&lt;a href=\&quot;./${tmpDirName}\&quot; target=\&quot;_self\&quot;&gt;${tmpMapName}&lt;/a&gt;&lt;/li&gt;&quot; &gt;&gt; ${indexFile}
    fi
  done

  # 追加 /ul
  cat &gt;&gt; ${nginxDir}/index.html &lt;&lt;EOF
&lt;/ul&gt;
EOF

  echo &quot;按顺序追加映射文件内的文件夹完成&quot;
  return 0

}


# 追加文件夹内容到 mkdocs.yml
function appendPagesContent {
  local dstDir=$1;
  local tmpDir=$2;
  local indent=&quot;$3&quot;;

  local tmpFile;
  local tmpRelativeFilePath;
  local tmpBaseName;
  local tmpBaseNameWithoutExtension;

  local exitCode=0; # 返回 155 表示成功执行,且插入了内容,返回0表示成功执行

  # 先增加 index 
  tmpFile=&quot;${tmpDir}/index.md&quot;
  if ([ -f ${tmpFile} ]);then
    tmpRelativeFilePath=${tmpFile#${dstDir}/docs/}
    tmpBaseName=$(basename ${tmpFile})
    echo &quot;${indent}- Home: ${tmpRelativeFilePath}&quot; &gt;&gt; ${dstDir}/mkdocs.yml
    # 成功插入了内容,设置exitCode
    exitCode=155;
  fi

  # 将文件夹下面的md文档和文件夹加入到 mkdocs.yml
  for tmpFile in ${tmpDir}/*;do
    tmpRelativeFilePath=${tmpFile#${dstDir}/docs/}
    tmpBaseName=$(basename ${tmpFile})
    tmpBaseNameWithoutExtension=${tmpBaseName%.*}
    if ([ -f &quot;${tmpFile}&quot; ] &amp;&amp; [[ $(echo ${tmpFile} | tr 'A-Z' 'a-z') == *.md ]]);then
        if ([ ${tmpBaseNameWithoutExtension} = index ]);then
          continue;
        else 
          echo &quot;${indent}- ${tmpBaseNameWithoutExtension}: ${tmpRelativeFilePath}&quot; &gt;&gt; ${dstDir}/mkdocs.yml
      # 成功插入了内容,设置exitCode
          exitCode=155;
        fi
    fi

    if ([ -d &quot;${tmpFile}&quot; ]);then
      echo &quot;${indent}- ${tmpBaseNameWithoutExtension}:&quot; &gt;&gt; ${dstDir}/mkdocs.yml
      appendPagesContent ${dstDir} ${tmpFile} &quot;${indent}  &quot;
      local tmpReturnCode=$?
      if ([ ${tmpReturnCode} -ne 155 ]);then
    # 没有追加任何内容
    # 删除已追加的最后一行
    sed -i '$d' ${dstDir}/mkdocs.yml
      else
        # 成功插入了内容,设置exitCode
    exitCode=155;
      fi

    fi
  done

  # 将文件夹下面的非md文档放到一个html文件中展示
  # 生成一个临时文件
  tmpOtherFileMd=`mktemp`

  for tmpFile in ${tmpDir}/*;do
    tmpRelativeFilePath=${tmpFile#${dstDir}/docs/}
    tmpBaseName=$(basename ${tmpFile})
    if ([ -f &quot;${tmpFile}&quot; ] \
       &amp;&amp; ! [[ $(echo ${tmpFile} | tr 'A-Z' 'a-z') == *.md ]] \
       &amp;&amp; ! [[ $(echo ${tmpFile} | tr 'A-Z' 'a-z') == *.png ]] \
       &amp;&amp; ! [[ $(echo ${tmpFile} | tr 'A-Z' 'a-z') == *.jpg ]] \
      );then
      echo &quot;###### [${tmpBaseName}](./${tmpBaseName})&quot; &gt;&gt; ${tmpOtherFileMd}
    fi
  done

  if ([ -n &quot;$(cat ${tmpOtherFileMd})&quot; ]);then
    # 将临时生成的md文件拷贝到目标文件夹
    tmpFile=&quot;${tmpDir}/其他文档(自动生成).md&quot;
    tmpRelativeFilePath=${tmpFile#${dstDir}/docs/}
    tmpBaseName=$(basename ${tmpFile})
    tmpBaseNameWithoutExtension=${tmpBaseName%.*}

    mv ${tmpOtherFileMd} &quot;${tmpFile}&quot;
    # 将md文件添加到mkdocs
    echo &quot;${indent}- ${tmpBaseNameWithoutExtension}: ${tmpRelativeFilePath}&quot; &gt;&gt; ${dstDir}/mkdocs.yml
    # 成功插入了内容,设置exitCode
    exitCode=155;
  fi 

  # 返回指定状态码
  return ${exitCode};
}

# ================ 默认参数定义区 ================
gitusername='globalreader'
gitpasswd='12345qwert'
branch='master'

# 定义使用帮助说明
helpMsg=&quot;
所有参数不区分大小写
--gituri docs项目git地址
&quot;

# ================ 处理选项 ================
while [ -n &quot;$1&quot; ];do
    tmpOpt=$(echo &quot;$1&quot;|tr A-Z a-z)
    # 判断参数是否是 --help , 是则显示帮助并退出
    if ([ $tmpOpt = &quot;--help&quot; ]);then
        echo &quot;${helpMsg}&quot;
        exit 0
    fi

    # 判断参数是否是 --bool开头,如果是则将变量置为1 并 shift 1
    if ([[ $tmpOpt = --bool* ]]);then
        tmpOpt=${tmpOpt#--}
        echo &quot;检测到参数 ${tmpOpt}&quot;
        export &quot;${tmpOpt}&quot;=&quot;1&quot;
        shift 1
        continue
    fi

    # 判断参数是否是 --开头,如果是则将变量置为下一个参数 并 shift 2
    if ([[ $tmpOpt = --* ]]);then
        tmpOpt=${tmpOpt#--}
        echo &quot;检测到参数 ${tmpOpt} = $2&quot;
        export &quot;${tmpOpt}&quot;=&quot;$2&quot;
        shift 2
        if ([ $? -ne 0 ]);then
          shift 1
        fi
        continue
    fi

    shift 1
done

# ================ 检查参数 ================
echo &quot;检查参数&quot;

echo &quot;检查gituri&quot;
if ([ -z &quot;${gituri}&quot; ]);then
   echo
   echo &quot;请指定 gituri&quot;
   echo &quot;具体帮助如下:&quot;
   echo &quot;${helpMsg}&quot;
   echo
   exit 1
fi

# ================ 开始执行 ================

# ================ git 检出代码 ================
echo &quot;使用git检出代码&quot;

# 生成一个临时文件夹 用于存放 检出的代码
tmpMkdocsDir=`mktemp -d`
tmpGitDir=&quot;${tmpMkdocsDir}/docs&quot;

# 检出代码
echo &quot;git clone --branch ${branch} --single-branch ${gituri} ${tmpGitDir} 1&gt;/dev/null&quot;
# 把gituri加上用户名和密码
tmpHostAndPort=$(echo &quot;${gituri}&quot; | grep -oP '(?&lt;=://)[^/]+?\.[^/]+(?=/?)|^[^/]+?\.[^/]+(?=/?)')
gitrealuri=${gituri/${tmpHostAndPort}/${gitusername}:${gitpasswd}@${tmpHostAndPort}}

git clone --branch ${branch} --single-branch ${gitrealuri} ${tmpGitDir} 1&gt;/dev/null
if ([ $? -ne 0 ]);then
  echo
  echo &quot;git clone failed!&quot;
  rm -rf ${tmpMkdocsDir}
  echo
  exit 1
fi

# 加入 site_name 到 mkdocs.yml
tmpBaseName=$(basename ${gituri})
mySiteName=${tmpBaseName%.*}

cat &gt; ${tmpMkdocsDir}/mkdocs.yml &lt;&lt; EOF
site_name: $(getMapNameForGitProjectName ${mySiteName})  
pages:
EOF

# 使用README作为index.md 
if (! [ -f ${tmpGitDir}/README.md ]);then
  echo &quot;&lt;a href=\&quot;../\&quot;&gt;Back&lt;/a&gt;&lt;br /&gt;&quot; &gt; ${tmpGitDir}/index.md
else
  sed -i '1i\ &lt;a href=\&quot;../\&quot;&gt;Back&lt;/a&gt;&lt;br /&gt;' ${tmpGitDir}/README.md
  mv -f ${tmpGitDir}/README.md ${tmpGitDir}/index.md
fi
# 生成 mkdocs.yml
appendPagesContent ${tmpMkdocsDir} ${tmpGitDir} &quot;&quot;

# 加入 theme 到 mkdocs.yml
cat &gt;&gt; ${tmpMkdocsDir}/mkdocs.yml &lt;&lt; EOF
theme: windmill
EOF

# 运行 mkdocs build, 该命令会生成一个 mySiteName 目录
cd ${tmpMkdocsDir}
echo 
echo &quot;cat ${tmpMkdocsDir}/mkdocs.yml&quot;
cat ${tmpMkdocsDir}/mkdocs.yml
echo
echo
mkdocs build  -d ${tmpMkdocsDir}/${mySiteName}
if ([ $? -ne 0 ]);then
  echo
  echo &quot;mkdocs build failed!&quot;
  rm -rf ${tmpMkdocsDir}
  echo
  exit 1
fi

# 将 build 后的文件拷贝到指定位置
nginxDir=/usr/share/nginx/html/docs

rm -rf ${nginxDir}/${mySiteName}
cp -r ${tmpMkdocsDir}/${mySiteName} ${nginxDir}/${mySiteName}
# 生成 index.html
cat &gt; ${nginxDir}/index.html &lt;&lt;EOF
&lt;head&gt;
&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot;&gt;
&lt;title&gt;MyDocs&lt;/title&gt;
  &lt;style type=&quot;text/css&quot;&gt;
    ul,li{ padding:10;margin:10;}
  &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;ul&gt;
EOF

# 遍历nginx根目录下的文件夹，获取其映射后的名称 加入到index.html中

# 先按顺序加入文档连接
doAddLinkForProjectInMap &quot;${nginxDir}&quot; &quot;${nginxDir}/index.html&quot;

# 继续遍历nginx根目录下加入未映射到的文件夹

# 追加 ul
cat &gt;&gt; ${nginxDir}/index.html &lt;&lt;EOF
&lt;ul&gt;
EOF

for file in ${nginxDir}/*;do
  if ([ $(basename ${file}) != &quot;index.html&quot; ]);then
    tmpMappedName=$(getMapNameForGitProjectName ${file});
    tmpRetCode=$?
    # 存在映射的文档之前已经加过了,所以这时只添加未映射的文档
    # tmpRetCode = 155 表示获取到了映射名称
    if ([ ${tmpRetCode} -ne 155 ]);then
      echo &quot;&lt;li&gt;&lt;a href=\&quot;./${file#${nginxDir}/}\&quot; target=\&quot;_blank\&quot;&gt;${tmpMappedName}&lt;/a&gt;&lt;/li&gt;&quot; &gt;&gt; ${nginxDir}/index.html
    fi
  fi
done

# 追加 /ul
cat &gt;&gt; ${nginxDir}/index.html &lt;&lt;EOF
&lt;/ul&gt;
EOF

# 追加 /body
cat &gt;&gt; ${nginxDir}/index.html &lt;&lt;EOF
&lt;/body&gt;
EOF

# 结束后删除文件
rm -rf ${tmpMkdocsDir}

echo &quot;成功使用mkdocs部署文档项目${gituri}&quot;
echo</code></pre>


<h2 id="_4">中文搜索问题<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h2>
<pre class="codehilite"><code class="language-python"># 安装分词工具
pip install jieba

# 修改 /usr/lib/python2.7/site-packages/mkdocs/contrib/legacy_search/search_index.py
    def generate_search_index(self):
        &quot;&quot;&quot;python to json conversion&quot;&quot;&quot;
        page_dicts = {
            'docs': self._entries,
        }
        # 以下为新增部分
        for doc in page_dicts['docs']:
        # 调用jieba的cut接口生成分词库，过滤重复词，过滤空格
            tokens = list(set([token.lower() for token in jieba.cut_for_search(doc['title'].replace('\n', ''), True)]))
            if '' in tokens:
                tokens.remove('')
            doc['title_tokens'] = tokens

            tokens = list(set([token.lower() for token in jieba.cut_for_search(doc['text'].replace('\n', ''), True)]))
            if '' in tokens:
                tokens.remove('')
            doc['text_tokens'] = tokens

        # 新增部分结束
        return json.dumps(page_dicts, sort_keys=True, indent=4)

# 修改 /usr/lib/python2.7/site-packages/mkdocs/contrib/legacy_search/templates/search/lunr.min.js
# 这个是压缩过的, 是不是可以下载一个未压缩版的, 应该更好修改
# 有两个地方要修改：
# lunr.Index.prototype.add: 获取分词数据的方式，不在从内部的分词接口计算分词，直接从文档的词库加载
# lunr.trimmer: 过滤空白字符的接口，修改匹配方式，把原来只匹配字母、数字改成匹配所有非空字符

lunr.Index.prototype.add = function (doc, emitEvent) {
  var docTokens = {},
      allDocumentTokens = new lunr.SortedSet,
      docRef = doc[this._ref],
      emitEvent = emitEvent === undefined ? true : emitEvent

  this._fields.forEach(function (field) {
    // 删掉内部接口计算分词
    // var fieldTokens = this.pipeline.run(this.tokenizerFn(doc[field.name]))
    // 直接从文档词库加载
    var fieldTokens = doc[field.name + '_tokens']

    docTokens[field.name] = fieldTokens

    for (var i = 0; i &lt; fieldTokens.length; i++) {
      var token = fieldTokens[i]
      allDocumentTokens.add(token)
      this.corpusTokens.add(token)
    }
  }, this)


lunr.trimmer = function (token) {
  var result = token.replace(/^\s+/, '').replace(/\s+$/, '')  //  \W -&gt; \s
  return result === '' ? undefined : result
}</code></pre>


<p>参考 基于mkdocs-material搭建个人静态博客(含支持的markdown语法)</p>
<p><a href="https://cyent.github.io/markdown-with-mkdocs-material/">点击阅读</a></p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../gitstudy/" class="btn btn-neutral float-right" title="Git的黑魔法">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../cicd/" class="btn btn-neutral" title="CI/CD"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../cicd/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../gitstudy/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../search/main.js" defer></script>

</body>
</html>
